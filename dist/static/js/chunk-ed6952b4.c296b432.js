(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed6952b4"],{"22ce":function(e,t,i){"use strict";i.d(t,"f",(function(){return s})),i.d(t,"d",(function(){return a})),i.d(t,"b",(function(){return l})),i.d(t,"e",(function(){return o})),i.d(t,"i",(function(){return c})),i.d(t,"g",(function(){return n})),i.d(t,"c",(function(){return u})),i.d(t,"j",(function(){return m})),i.d(t,"a",(function(){return _})),i.d(t,"h",(function(){return d}));var r=i("b775");function s(e){return Object(r["a"])({url:"/service/service_list",method:"get",params:e})}function a(e){return Object(r["a"])({url:"/service/service_delete",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/service/service_add_http",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/service/service_detail",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/service/service_update_http",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/service/service_stat",method:"get",params:e})}function u(e){return Object(r["a"])({url:"/service/service_add_tcp",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/service/service_update_tcp",method:"post",data:e})}function _(e){return Object(r["a"])({url:"/service/service_add_grpc",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/service/service_update_grpc",method:"post",data:e})}},"489f":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mixin-components-container"},[i("el-row",[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[1==e.isEdit?i("span",[e._v("创建GRPC服务")]):e._e(),0==e.isEdit?i("span",[e._v("修改GRPC服务")]):e._e()]),i("div",{staticStyle:{"margin-bottom":"50px"}},[i("el-form",{ref:"form",attrs:{model:e.sizeForm,"label-width":"140px",size:"mini"}},[i("el-form-item",{staticClass:"is-required",attrs:{label:"服务名称"}},[i("el-input",{attrs:{placeholder:"6~128位字母数字下划线",disabled:1==e.isEdit},model:{value:e.sizeForm.service_name,callback:function(t){e.$set(e.sizeForm,"service_name",t)},expression:"sizeForm.service_name"}})],1),i("el-form-item",{staticClass:"is-required",attrs:{label:"服务描述"}},[i("el-input",{attrs:{placeholder:"最多255字符，必填"},model:{value:e.sizeForm.service_desc,callback:function(t){e.$set(e.sizeForm,"service_desc",t)},expression:"sizeForm.service_desc"}})],1),i("el-form-item",{staticClass:"is-required",attrs:{label:"端口"}},[i("el-input",{attrs:{disabled:!0===e.isEdit,placeholder:"需要设置8001-8999范围内数字，必填"},model:{value:e.sizeForm.port,callback:function(t){e.$set(e.sizeForm,"port",t)},expression:"sizeForm.port"}})],1),i("el-form-item",{attrs:{label:"metadata转换"}},[i("el-input",{attrs:{placeholder:"metadata转换支持增加(add)、删除(del)、修改(edit) 格式: add headname headvalue 多条换行",type:"textarea",autosize:{minRows:2,maxRows:20}},model:{value:e.sizeForm.header_transfor,callback:function(t){e.$set(e.sizeForm,"header_transfor",t)},expression:"sizeForm.header_transfor"}})],1),i("el-form-item",{attrs:{label:"开启验证"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.sizeForm.open_auth,callback:function(t){e.$set(e.sizeForm,"open_auth",t)},expression:"sizeForm.open_auth"}})],1),i("el-form-item",{attrs:{label:"IP白名单"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"格式: 127.0.0.1 多条换行，白名单优先级高于黑名单"},model:{value:e.sizeForm.white_list,callback:function(t){e.$set(e.sizeForm,"white_list",t)},expression:"sizeForm.white_list"}})],1),i("el-form-item",{attrs:{label:"IP黑名单"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"格式: 127.0.0.1 多条换行"},model:{value:e.sizeForm.black_list,callback:function(t){e.$set(e.sizeForm,"black_list",t)},expression:"sizeForm.black_list"}})],1),i("el-form-item",{attrs:{label:"客户端限流"}},[i("el-input",{attrs:{placeholder:"0表示无限制"},model:{value:e.sizeForm.clientip_flow_limit,callback:function(t){e.$set(e.sizeForm,"clientip_flow_limit",t)},expression:"sizeForm.clientip_flow_limit"}})],1),i("el-form-item",{attrs:{label:"服务端限流"}},[i("el-input",{attrs:{placeholder:"0表示无限制"},model:{value:e.sizeForm.service_flow_limit,callback:function(t){e.$set(e.sizeForm,"service_flow_limit",t)},expression:"sizeForm.service_flow_limit"}})],1),i("el-form-item",{attrs:{label:"轮询方式"}},[i("el-radio-group",{model:{value:e.sizeForm.round_type,callback:function(t){e.$set(e.sizeForm,"round_type",t)},expression:"sizeForm.round_type"}},[i("el-radio",{attrs:{label:0}},[e._v("random")]),i("el-radio",{attrs:{label:1}},[e._v("round-robin")]),i("el-radio",{attrs:{label:2}},[e._v("weight_round_robin")]),i("el-radio",{attrs:{label:3}},[e._v("ip_hash")])],1)],1),i("el-form-item",{staticClass:"is-required",attrs:{label:"IP列表"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"格式: 127.0.0.1:80 多条换行"},model:{value:e.sizeForm.ip_list,callback:function(t){e.$set(e.sizeForm,"ip_list",t)},expression:"sizeForm.ip_list"}})],1),i("el-form-item",{staticClass:"is-required",attrs:{label:"权重列表"}},[i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"格式50 多条换行"},model:{value:e.sizeForm.weight_list,callback:function(t){e.$set(e.sizeForm,"weight_list",t)},expression:"sizeForm.weight_list"}})],1),i("el-form-item",{attrs:{size:"large"}},[i("el-button",{attrs:{type:"primary",disabled:e.submitButDisabled},on:{click:e.handleSubmit}},[e._v("立即提交")])],1)],1)],1)])],1)],1)},s=[],a=(i("ac1f"),i("5319"),i("d3b7"),i("25f0"),i("a9e3"),i("22ce")),l={name:"ServiceCreateGrpc",data:function(){return{isEdit:!1,submitButDisabled:!1,sizeForm:{service_name:"",service_desc:"",rule_type:0,rule:"",need_https:0,need_websocket:0,need_strip_uri:1,url_rewrite:"",header_transfor:"",round_type:2,ip_list:"",weight_list:"",upstream_connect_timeout:"",upstream_header_timeout:"",upstream_idle_timeout:"",upstream_max_idle:"",open_auth:0,black_list:"",white_list:"",clientip_flow_limit:"",service_flow_limit:"",white_host_name:"",port:""}}},created:function(){var e=this.$route.params&&this.$route.params.id;e>0&&(this.isEdit=!0,this.fetchData(e))},methods:{fetchData:function(e){var t=this,i={id:e};Object(a["e"])(i).then((function(e){var i=e.data;t.sizeForm.id=i.info.id,t.sizeForm.service_name=i.info.service_name,t.sizeForm.service_desc=i.info.service_desc,t.sizeForm.rule_type=i.http_rule.rule_type,t.sizeForm.rule=i.http_rule.rule,t.sizeForm.url_rewrite=i.http_rule.url_rewrite.replace(/,/g,"\n"),t.sizeForm.header_transfor=i.grpc_rule.header_transfor.replace(/,/g,"\n"),t.sizeForm.round_type=i.load_balance.round_type,t.sizeForm.ip_list=i.load_balance.ip_list,t.sizeForm.weight_list=i.load_balance.weight_list.replace(/,/g,"\n"),t.sizeForm.round_type=i.load_balance.round_type,t.sizeForm.upstream_connect_timeout=i.load_balance.upstream_connect_timeout,t.sizeForm.upstream_header_timeout=i.load_balance.upstream_header_timeout,t.sizeForm.upstream_idle_timeout=i.load_balance.upstream_idle_timeout,t.sizeForm.upstream_max_idle=i.load_balance.upstream_max_idle,t.sizeForm.open_auth=i.access_control.open_auth,t.sizeForm.black_list=i.access_control.black_list.replace(/,/g,"\n"),t.sizeForm.white_list=i.access_control.white_list.replace(/,/g,"\n"),t.sizeForm.clientip_flow_limit=i.access_control.clientip_flow_limit,t.sizeForm.service_flow_limit=i.access_control.service_flow_limit,t.sizeForm.white_host_name=i.access_control.white_host_name.replace(/,/g,"\n"),t.sizeForm.port=i.grpc_rule.port.toString()})).catch((function(){}))},handleSubmit:function(){var e=this;this.submitButDisabled=!0;var t=Object.assign({},this.sizeForm);console.log(t),t.white_list=t.white_list.replace(/\n/g,","),t.black_list=t.black_list.replace(/\n/g,","),t.url_rewrite=t.url_rewrite.replace(/\n/g,","),t.header_transfor=t.header_transfor.replace(/\n/g,","),t.ip_list=t.ip_list.replace(/\n/g,","),t.weight_list=t.weight_list.replace(/\n/g,","),t.white_host_name=t.white_host_name.replace(/\n/g,","),t.port=Number(t.port),t.rule_type=Number(t.rule_type),t.clientip_flow_limit=Number(t.clientip_flow_limit),t.service_flow_limit=Number(t.service_flow_limit),t.upstream_connect_timeout=Number(t.upstream_connect_timeout),t.upstream_header_timeout=Number(t.upstream_header_timeout),t.upstream_idle_timeout=Number(t.upstream_idle_timeout),t.upstream_max_idle=Number(t.upstream_max_idle),this.isEdit?Object(a["h"])(t).then((function(t){e.submitButDisabled=!1,e.$notify({title:"Success",message:"修改成功",type:"success",duration:2e3})})).catch((function(){e.submitButDisabled=!1})):Object(a["a"])(t).then((function(t){e.submitButDisabled=!1,e.$notify({title:"Success",message:"添加成功",type:"success",duration:2e3})})).catch((function(){e.submitButDisabled=!1}))}}},o=l,c=(i("9a30"),i("2877")),n=Object(c["a"])(o,r,s,!1,null,"35b80d89",null);t["default"]=n.exports},"9a30":function(e,t,i){"use strict";i("c6b5")},c6b5:function(e,t,i){}}]);